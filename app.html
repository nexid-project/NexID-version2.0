<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexID</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.1/dist/browser-image-compression.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen overflow-x-hidden">

    <!-- Página de Carga -->
    <div id="loading-page" class="fixed inset-0 flex items-center justify-center bg-gray-900 z-50">
        <div class="loader"></div>
    </div>
    
    <!-- Página de Autenticación -->
    <main id="auth-page" class="hidden flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-md space-y-6">
            <div class="text-center">
                <img src="https://i.ibb.co/F8b34vG/logo-nexid-version-2-0-1.png" alt="Logo NexID" class="w-32 mx-auto mb-4">
                <h1 class="text-3xl font-bold">Bienvenido a NexID</h1>
                <p class="text-gray-400">Tu identidad digital, simplificada.</p>
            </div>
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4">
                <div class="relative">
                    <input id="email-input" type="email" placeholder="Correo electrónico" class="auth-input">
                </div>
                <div class="relative">
                    <input id="password-input" type="password" placeholder="Contraseña" class="auth-input">
                    <button id="auth-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400">
                        <i data-lucide="eye" class="w-5 h-5"></i>
                    </button>
                </div>
                <button id="login-btn" class="w-full btn-primary">Iniciar Sesión</button>
                <div class="text-center">
                    <a href="#" id="forgot-password-link" class="text-sm text-cyan-400 hover:underline">¿Olvidaste tu contraseña?</a>
                </div>
                <div class="flex items-center justify-center space-x-2">
                    <span class="h-px bg-gray-600 w-full"></span>
                    <span class="text-gray-400 text-sm">o</span>
                    <span class="h-px bg-gray-600 w-full"></span>
                </div>
                <button id="google-login-btn" class="w-full btn-secondary">
                    <svg class="w-5 h-5 mr-2" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M44.5 20H24v8h11.3c-1.6 5.2-6.4 9-11.3 9-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.8 1.2 7.9 3.1l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z" fill="#FFC107"/><path d="M44.5 20H24v8h11.3c-1.6 5.2-6.4 9-11.3 9-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.8 1.2 7.9 3.1l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z" fill="#FFC107"/><path d="M44.5 20H24v8h11.3c-1.6 5.2-6.4 9-11.3 9-3.7 0-7-1.7-9.2-4.4l7.1-5.5c1.2 2.2 3.6 3.7 6.1 3.7 3.5 0 6.5-2.4 7.6-5.7H24v-8h20.5z" fill="#4CAF50"/><path d="M2.3 24c0-1.2.2-2.4.6-3.5L9 26.5c-.1.8-.1 1.7-.1 2.5s0 1.7.1 2.5L2.9 35.5c-.4-1.1-.6-2.3-.6-3.5z" fill="#F44336"/><path d="M24 46c5.9 0 11.2-1.9 15.1-5.1l-7.1-5.5c-2.1 1.4-4.6 2.2-7.3 2.2-4.4 0-8.2-2.6-9.8-6.2l-7.2 5.6C7 42.1 15 46 24 46z" fill="#1565C0"/><path d="M43.6 14.9C39.7 11.1 34.3 9 28 9c-4.4 0-8.2 2.6-9.8 6.2l7.2 5.6c1.2-2.2 3.6-3.7 6.1-3.7 3.5 0 6.5-2.4 7.6-5.7z" fill="#1E88E5"/></svg>
                    Continuar con Google
                </button>
                 <p class="text-sm text-center text-gray-400">¿No tienes cuenta? <a href="#" id="show-register-modal-btn" class="font-medium text-cyan-400 hover:underline">Regístrate</a></p>
            </div>
        </div>
    </main>
    
    <!-- Página de Bienvenida / Configuración Inicial -->
    <main id="welcome-page" class="hidden flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-md space-y-6 text-center">
             <img src="https://i.ibb.co/F8b34vG/logo-nexid-version-2-0-1.png" alt="Logo NexID" class="w-32 mx-auto mb-4">
             <h1 class="text-3xl font-bold">¡Casi listo!</h1>
             <p class="text-gray-400">Elige tu nombre de usuario único para completar tu perfil.</p>
             <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4 text-left">
                <div>
                    <label for="welcome-display-name-input" class="block mb-2 text-sm font-medium">Nombre a mostrar</label>
                    <input id="welcome-display-name-input" type="text" placeholder="Tu nombre o el de tu marca" class="auth-input">
                </div>
                <div>
                     <label for="welcome-username-input" class="block mb-2 text-sm font-medium">Nombre de usuario</label>
                     <div class="flex items-center">
                        <span class="inline-flex items-center px-3 text-sm text-gray-400 bg-gray-700 border border-r-0 border-gray-600 rounded-l-md h-12">@</span>
                        <input id="welcome-username-input" type="text" placeholder="tunombre" class="auth-input !rounded-l-none">
                     </div>
                     <p id="username-feedback" class="text-sm mt-2 h-5"></p>
                </div>
                <button id="complete-setup-btn" class="w-full btn-primary" disabled>Completar Configuración</button>
             </div>
        </div>
    </main>
    
    <!-- Página de Olvidé Contraseña -->
    <main id="forgot-password-page" class="hidden flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-md space-y-6 text-center">
            <h1 class="text-3xl font-bold">Recuperar Contraseña</h1>
            <p class="text-gray-400">Ingresa tu correo y te enviaremos un enlace para restablecerla.</p>
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4 text-left">
                <div>
                    <label for="recovery-email-input" class="block mb-2 text-sm font-medium">Correo electrónico</label>
                    <input id="recovery-email-input" type="email" placeholder="tu@correo.com" class="auth-input">
                </div>
                <button id="send-recovery-btn" class="w-full btn-primary">Enviar Enlace</button>
                <div class="text-center">
                    <a href="#" id="back-to-login-link-from-forgot" class="text-sm text-cyan-400 hover:underline">Volver a iniciar sesión</a>
                </div>
            </div>
        </div>
    </main>

    <!-- Página de Actualizar Contraseña -->
    <main id="update-password-page" class="hidden flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-md space-y-6 text-center">
            <h1 class="text-3xl font-bold">Crea una nueva contraseña</h1>
            <p class="text-gray-400">Asegúrate de que sea segura.</p>
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4 text-left">
                <div>
                    <label for="update-password-input" class="block mb-2 text-sm font-medium">Nueva Contraseña</label>
                    <div class="relative">
                        <input id="update-password-input" type="password" class="auth-input">
                        <button id="update-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button>
                    </div>
                </div>
                <div>
                    <label for="update-confirm-password-input" class="block mb-2 text-sm font-medium">Confirmar Nueva Contraseña</label>
                     <div class="relative">
                        <input id="update-confirm-password-input" type="password" class="auth-input">
                         <button id="update-confirm-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button>
                    </div>
                </div>
                <button id="update-password-btn" class="w-full btn-primary">Actualizar Contraseña</button>
            </div>
        </div>
    </main>
    
    <!-- Página de Reactivar Cuenta -->
    <main id="reactivate-account-page" class="hidden flex items-center justify-center min-h-screen p-4">
        <div class="w-full max-w-lg space-y-6 text-center">
            <h1 class="text-3xl font-bold text-red-500">Tu cuenta está desactivada</h1>
            <p class="text-gray-300">Tu cuenta ha sido programada para eliminación permanente el <strong id="deletion-date"></strong>. Si no haces nada, todos tus datos serán borrados de forma irreversible.</p>
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4">
                <p class="text-lg">¿Deseas reactivar tu cuenta y cancelar la eliminación?</p>
                <div class="flex gap-4">
                    <button id="reactivate-account-btn" class="w-full btn-primary !bg-green-600 hover:!bg-green-500">Sí, reactivar mi cuenta</button>
                    <button id="logout-for-deletion-btn" class="w-full btn-secondary">No, cerrar sesión</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Fondo Global (para la página de perfil) -->
    <div id="global-background" class="fixed inset-0 bg-cover bg-center transition-opacity duration-500" style="opacity: 0;"></div>

    <!-- Página de Perfil Principal -->
    <div id="profile-page" class="hidden">
        <header id="main-header" class="fixed top-0 left-0 right-0 z-30 p-4 flex justify-between items-center">
            <div id="search-container" class="search-container relative">
                <button id="search-icon-btn" class="p-2 rounded-full hover:bg-white/10 transition-colors">
                    <i data-lucide="search" class="w-6 h-6"></i>
                </button>
                <input type="text" id="search-input" placeholder="Buscar perfiles..." class="search-input">
                <div id="search-results" class="search-results hidden"></div>
            </div>
            <div class="flex items-center gap-2">
                 <a href="#" id="back-to-my-profile-btn" class="hidden p-2 rounded-full hover:bg-white/10 transition-colors" title="Volver a mi perfil">
                    <i data-lucide="arrow-left" class="w-6 h-6"></i>
                </a>
                <button id="configure-btn" class="btn-secondary !py-2 !px-3"><i data-lucide="settings-2" class="w-6 h-6"></i></button>
                <button id="logout-btn" class="btn-secondary !py-2 !px-3 !bg-red-600/20 !text-red-400 hover:!bg-red-600/30"><i data-lucide="log-out" class="w-6 h-6"></i></button>
            </div>
        </header>

        <main class="content-wrapper">
            <div class="max-w-2xl mx-auto pt-24 pb-16" id="profile-layout-container">
                <!-- El contenido del perfil se renderiza aquí -->
            </div>
        </main>
        
         <!-- Acciones de Usuario (Compartir, Contacto) -->
        <div id="user-actions" class="fixed bottom-6 right-6 z-30">
        </div>
        
        <!-- Acciones del Modo Diseño -->
        <div id="layout-actions" class="hidden fixed bottom-6 inset-x-0 z-30 flex justify-center items-center gap-4">
            <button id="save-layout-btn" class="flex items-center gap-2 px-6 py-3 rounded-full bg-green-600 text-white font-bold shadow-lg transform hover:scale-105 transition-transform"><i data-lucide="check" class="w-5 h-5"></i> Guardar</button>
            <button id="cancel-layout-btn" class="flex items-center gap-2 px-6 py-3 rounded-full bg-red-600 text-white font-bold shadow-lg transform hover:scale-105 transition-transform"><i data-lucide="x" class="w-5 h-5"></i> Cancelar</button>
        </div>
    </div>
    
    <!-- Overlay para el panel de configuración -->
    <div id="settings-overlay" class="fixed inset-0 bg-black/50 z-30 hidden"></div>
    
    <!-- Panel de Configuración Deslizante -->
    <aside id="settings-panel" class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white shadow-lg z-40">
        <div id="panel-dragger-container" class="absolute -top-4 left-0 right-0 h-8 flex justify-center items-center cursor-ns-resize">
            <div class="w-12 h-1.5 bg-gray-600 rounded-full"></div>
        </div>
        <div id="settings-panel-header" class="p-4 border-b border-gray-700 flex justify-between items-center">
            <h2 class="text-xl font-bold">Configuración</h2>
            <button id="close-settings-btn" class="p-2 rounded-full hover:bg-gray-700"><i data-lucide="x" class="w-6 h-6"></i></button>
        </div>
        <div id="settings-panel-content" class="p-4 space-y-6 overflow-y-auto">
            
            <div id="settings-accordion" class="space-y-2">
                <!-- Apariencia -->
                <div class="accordion-item">
                    <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="palette"></i><span>Apariencia</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content">
                        <!-- Pestañas de Temas -->
                        <div class="theme-tabs">
                            <nav id="theme-tabs" class="theme-tabs-nav">
                                <button class="theme-tab-btn active" data-tab="modernos">Modernos</button>
                                <button class="theme-tab-btn" data-tab="minimalistas">Minimalistas</button>
                                <button class="theme-tab-btn" data-tab="vibrantes">Vibrantes</button>
                            </nav>
                            <div id="theme-tab-contents" class="theme-tabs-content">
                                <div id="tab-modernos" class="theme-tab-content active">
                                    <div class="theme-grid">
                                        <div class="theme-option" data-theme="grafito"><div class="theme-preview"></div><span>Grafito</span></div>
                                        <div class="theme-option" data-theme="oceano"><div class="theme-preview"></div><span>Océano</span></div>
                                        <div class="theme-option" data-theme="bosque"><div class="theme-preview"></div><span>Bosque</span></div>
                                    </div>
                                </div>
                                <div id="tab-minimalistas" class="theme-tab-content">
                                     <div class="theme-grid">
                                        <div class="theme-option" data-theme="negro"><div class="theme-preview"></div><span>Negro</span></div>
                                        <div class="theme-option" data-theme="blanco"><div class="theme-preview"></div><span>Blanco</span></div>
                                     </div>
                                </div>
                                <div id="tab-vibrantes" class="theme-tab-content">
                                     <div class="theme-grid">
                                         <div class="theme-option" data-theme="neon"><div class="theme-preview"></div><span>Neón</span></div>
                                         <div class="theme-option" data-theme="solar"><div class="theme-preview"></div><span>Solar</span></div>
                                     </div>
                                </div>
                            </div>
                        </div>

                        <!-- Fondo -->
                        <div class="mt-4">
                            <label class="block mb-2 text-sm font-medium">Fondo Personalizado</label>
                            <div class="flex gap-2">
                                <button id="upload-background-btn" class="btn-form flex-1"><i data-lucide="upload-cloud" class="w-5 h-5"></i> Subir Fondo</button>
                                <button id="open-library-btn" class="btn-form flex-1"><i data-lucide="library" class="w-5 h-5"></i> Biblioteca</button>
                            </div>
                            <input type="file" id="background-upload-input" class="hidden" accept="image/*">
                            <input type="hidden" id="background-image-path-input">
                            <div class="flex items-center mt-2">
                                <input id="background-image-url-input" type="text" placeholder="O pega la URL de una imagen..." class="auth-input flex-grow">
                                <button id="remove-background-btn" class="p-3 text-red-500 hover:text-red-400"><i data-lucide="trash-2" class="w-5 h-5"></i></button>
                            </div>
                             <div id="background-controls" class="mt-2 hidden">
                                <label for="background-opacity-slider" class="block mb-1 text-sm font-medium">Opacidad de la capa</label>
                                <input id="background-opacity-slider" type="range" min="0" max="1" step="0.05" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                            </div>
                        </div>

                        <!-- Estilo de Botones -->
                        <div class="mt-4">
                            <label class="block mb-2 text-sm font-medium">Estilo de Botones</label>
                            <div class="grid grid-cols-2 gap-2">
                                <div><input type="radio" id="style-filled" name="buttonStyle" value="filled" class="hidden peer"><label for="style-filled" class="btn-radio-label">Relleno</label></div>
                                <div><input type="radio" id="style-outline" name="buttonStyle" value="outline" class="hidden peer"><label for="style-outline" class="btn-radio-label">Contorno</label></div>
                                <div><input type="radio" id="style-soft" name="buttonStyle" value="soft" class="hidden peer"><label for="style-soft" class="btn-radio-label">Suave</label></div>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label class="block mb-2 text-sm font-medium">Forma de Botones</label>
                            <div class="grid grid-cols-2 gap-2">
                                <div><input type="radio" id="shape-rounded" name="buttonShape" value="rounded-lg" class="hidden peer"><label for="shape-rounded" class="btn-radio-label">Redondeado</label></div>
                                <div><input type="radio" id="shape-full" name="buttonShape" value="rounded-full" class="hidden peer"><label for="shape-full" class="btn-radio-label">Píldora</label></div>
                                <div><input type="radio" id="shape-square" name="buttonShape" value="rounded-none" class="hidden peer"><label for="shape-square" class="btn-radio-label">Recto</label></div>
                                <div><input type="radio" id="shape-underline" name="buttonShape" value="underline" class="hidden peer"><label for="shape-underline" class="btn-radio-label">Subrayado</label></div>
                            </div>
                        </div>
                         <!-- Selector de Fuente -->
                        <div class="mt-4">
                             <label class="block mb-2 text-sm font-medium">Fuente</label>
                            <div id="custom-font-selector" class="relative">
                                <input type="hidden" id="font-family-value">
                                <button type="button" id="font-selector-btn" class="w-full text-left p-3 bg-gray-700 rounded-lg flex justify-between items-center">
                                    <span id="font-selector-label"></span>
                                    <i data-lucide="chevrons-up-down" class="w-4 h-4 text-gray-400"></i>
                                </button>
                                <div id="font-selector-options" class="absolute bottom-full mb-2 w-full bg-gray-800 rounded-lg shadow-lg z-10 hidden max-h-60 overflow-y-auto">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Perfil -->
                <div class="accordion-item">
                    <div class="accordion-header">
                         <div class="flex items-center gap-3"><i data-lucide="user-circle"></i><span>Perfil</span></div>
                         <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-4">
                        <div>
                             <label for="display-name-input" class="block mb-2 text-sm font-medium">Nombre a mostrar</label>
                             <input id="display-name-input" type="text" class="auth-input">
                        </div>
                        <div>
                            <label for="username-input" class="block mb-2 text-sm font-medium">Nombre de usuario</label>
                            <div class="flex items-center">
                                <span class="inline-flex items-center px-3 text-sm text-gray-400 bg-gray-700 border border-r-0 border-gray-600 rounded-l-md h-12">@</span>
                                <input id="username-input" type="text" class="auth-input !rounded-l-none">
                            </div>
                        </div>
                        <div>
                            <label for="description-input" class="block mb-2 text-sm font-medium">Descripción</label>
                             <div class="relative">
                                <textarea id="description-input" rows="2" class="auth-input pr-12"></textarea>
                                <button id="open-gemini-btn" class="absolute top-2 right-2 p-2 rounded-full hover:bg-gray-600" title="Generar con IA">
                                    <i data-lucide="sparkles" class="w-5 h-5 text-purple-400"></i>
                                </button>
                            </div>
                        </div>
                         <div>
                            <label for="featured-video-url-input" class="block mb-2 text-sm font-medium">Video Destacado (YouTube, Vimeo)</label>
                            <input id="featured-video-url-input" type="text" placeholder="Pega la URL del video..." class="auth-input">
                        </div>
                    </div>
                </div>
                
                <!-- Galería / Portafolio -->
                <div class="accordion-item">
                     <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="gallery-horizontal"></i><span>Galería / Portafolio</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-4">
                        <div id="gallery-editor-list" class="grid grid-cols-3 gap-2">
                            <!-- Las miniaturas del editor de la galería se renderizarán aquí -->
                        </div>
                        <button id="add-gallery-image-btn" class="w-full btn-form">Añadir Imágenes (0/6)</button>
                        <input type="file" id="gallery-image-upload-input" class="hidden" accept="image/*" multiple>
                    </div>
                </div>

                <!-- Enlaces -->
                <div class="accordion-item">
                     <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="link"></i><span>Enlaces</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-4">
                        <div class="bg-gray-800 p-4 rounded-lg space-y-3">
                            <h3 id="link-form-title" class="font-bold">Añadir Nuevo Enlace</h3>
                             <input type="hidden" id="editing-link-id">
                            <div>
                                <label for="link-title-input" class="block mb-1 text-sm">Título</label>
                                <input id="link-title-input" type="text" class="auth-input">
                            </div>
                             <div>
                                <label for="link-url-input" class="block mb-1 text-sm">URL</label>
                                <input id="link-url-input" type="text" class="auth-input">
                            </div>
                            <div>
                                <label class="block mb-1 text-sm">Icono (opcional)</label>
                                <input type="hidden" id="link-icon-value">
                                <div id="icon-grid-container" class="grid grid-cols-8 gap-2">
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button id="add-update-link-btn" class="btn-primary flex-1">Añadir Enlace</button>
                                <button id="cancel-edit-btn" class="btn-secondary flex-1 hidden">Cancelar</button>
                            </div>
                        </div>
                        <div id="links-list-editor" class="space-y-2"></div>
                    </div>
                </div>
                
                <!-- Botones Sociales -->
                <div class="accordion-item">
                     <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="share-2"></i><span>Botones Sociales</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-2">
                        <p class="text-sm text-gray-400 -mt-2 mb-3">Añade enlaces a tus redes sociales principales, se mostrarán como botones grandes.</p>
                        <div id="social-buttons-inputs-container"></div>
                    </div>
                </div>

                 <!-- Iconos Sociales -->
                <div class="accordion-item">
                     <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="mouse-pointer-click"></i><span>Iconos Sociales</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-2">
                        <p class="text-sm text-gray-400 -mt-2 mb-3">Añade tus nombres de usuario. Se mostrarán como pequeños iconos en el pie de página.</p>
                        <div id="socials-inputs-container"></div>
                    </div>
                </div>

                 <!-- Información de Contacto -->
                <div class="accordion-item">
                     <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="contact"></i><span>Información de Contacto (vCard)</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-4" id="contact-inputs">
                        <p class="text-sm text-gray-400 -mt-2 mb-3">Completa estos campos para que los visitantes puedan descargar tu tarjeta de contacto digital.</p>
                        <div>
                             <label for="contact-name-input" class="block mb-1 text-sm">Nombre Completo</label>
                             <input id="contact-name-input" data-contact="name" type="text" class="auth-input">
                        </div>
                        <div>
                             <label for="contact-phone-input" class="block mb-1 text-sm">Teléfono</label>
                             <input id="contact-phone-input" data-contact="phone" type="tel" class="auth-input">
                        </div>
                        <div>
                             <label for="contact-email-input" class="block mb-1 text-sm">Correo</label>
                             <input id="contact-email-input" data-contact="email" type="email" class="auth-input">
                        </div>
                         <div>
                             <label for="contact-website-input" class="block mb-1 text-sm">Sitio Web</label>
                             <input id="contact-website-input" data-contact="website" type="text" class="auth-input">
                        </div>
                    </div>
                </div>

                <!-- Cuenta -->
                 <div class="accordion-item">
                    <div class="accordion-header">
                        <div class="flex items-center gap-3"><i data-lucide="shield"></i><span>Cuenta y Privacidad</span></div>
                        <i data-lucide="chevron-down" class="accordion-arrow"></i>
                    </div>
                    <div class="accordion-content space-y-4">
                        <div class="flex items-center justify-between bg-gray-800 p-3 rounded-lg">
                            <div>
                                <label for="private-profile-toggle" class="font-medium">Perfil Público</label>
                                <p class="text-sm text-gray-400">Permite que otros te encuentren en el buscador.</p>
                            </div>
                            <label class="switch"><input type="checkbox" id="private-profile-toggle"><span class="slider round"></span></label>
                        </div>
                        <button id="change-password-btn" class="w-full btn-form">Cambiar contraseña</button>
                        <button id="delete-account-btn" class="w-full btn-form !text-red-400 !border-red-500/50 hover:!bg-red-500/10">Desactivar cuenta</button>
                    </div>
                </div>


            </div>

        </div>
        <div id="settings-panel-footer" class="p-4 border-t border-gray-700">
            <button id="save-changes-btn" class="w-full btn-primary">Guardar Cambios</button>
        </div>
    </aside>

    <!-- Modals -->
    <!-- Cropper Modal -->
    <div id="cropper-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
            <h3 class="p-4 font-bold text-lg border-b border-gray-700">Ajusta tu imagen de perfil</h3>
            <div class="p-4">
                <div class="w-full h-64 bg-gray-900">
                    <img id="cropper-image" src="" class="max-w-full">
                </div>
            </div>
            <div class="p-4 flex justify-end gap-2 border-t border-gray-700">
                <button id="cropper-cancel-btn" class="btn-secondary">Cancelar</button>
                <button id="cropper-save-btn" class="btn-primary">Guardar Imagen</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Registro -->
    <div id="register-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
         <div class="w-full max-w-md space-y-6">
            <div class="bg-gray-800 p-8 rounded-lg shadow-lg space-y-4">
                 <h2 class="text-2xl font-bold text-center">Crear una cuenta</h2>
                 <div>
                    <label for="register-email-input" class="block mb-2 text-sm font-medium">Correo electrónico</label>
                    <input id="register-email-input" type="email" placeholder="tu@correo.com" class="auth-input">
                </div>
                <div>
                    <label for="register-password-input" class="block mb-2 text-sm font-medium">Contraseña</label>
                    <div class="relative">
                        <input id="register-password-input" type="password" placeholder="••••••••" class="auth-input">
                        <button id="register-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button>
                    </div>
                </div>
                 <div>
                    <label for="register-confirm-password-input" class="block mb-2 text-sm font-medium">Confirmar Contraseña</label>
                     <div class="relative">
                        <input id="register-confirm-password-input" type="password" placeholder="••••••••" class="auth-input">
                        <button id="register-confirm-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button>
                    </div>
                </div>
                <button id="create-account-btn" class="w-full btn-primary">Crear Cuenta</button>
                 <p class="text-sm text-center text-gray-400">¿Ya tienes una cuenta? <a href="#" id="back-to-login-link" class="font-medium text-cyan-400 hover:underline">Inicia sesión</a></p>
            </div>
        </div>
    </div>

    <!-- Modal Gemini -->
    <div id="gemini-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-lg w-full">
            <div class="p-4 flex justify-between items-center border-b border-gray-700">
                <h3 class="font-bold text-lg flex items-center gap-2"><i data-lucide="sparkles" class="w-5 h-5 text-purple-400"></i> Asistente de Biografía</h3>
                <button id="gemini-close-btn" class="p-2 rounded-full hover:bg-gray-700"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="p-4 space-y-4">
                <div>
                    <label for="gemini-keywords-input" class="block mb-2 text-sm font-medium">Escribe algunas palabras clave sobre ti o tu marca</label>
                    <input id="gemini-keywords-input" type="text" placeholder="Ej: Fotógrafo de bodas, apasionado, creativo..." class="auth-input">
                </div>
                <button id="gemini-generate-btn" class="w-full btn-primary">Generar Sugerencias</button>
                <div id="gemini-loader" class="hidden flex justify-center p-4"><div class="w-8 h-8 border-4 border-t-transparent border-cyan-400 rounded-full animate-spin"></div></div>
                <div id="gemini-results-container" class="space-y-2 max-h-60 overflow-y-auto"></div>
            </div>
             <div class="p-4 flex justify-end gap-2 border-t border-gray-700">
                <button id="gemini-use-text-btn" class="btn-primary">Usar Texto Seleccionado</button>
            </div>
        </div>
    </div>

    <!-- Modal Biblioteca -->
    <div id="library-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full">
             <div class="p-4 flex justify-between items-center border-b border-gray-700">
                <h3 class="font-bold text-lg">Biblioteca de Fondos</h3>
                <button id="library-close-btn" class="p-2 rounded-full hover:bg-gray-700"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="p-4 max-h-[70vh] overflow-y-auto">
                 <div id="library-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                 </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Cambios sin Guardar -->
    <div id="unsaved-changes-confirm" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-sm w-full p-6 text-center">
            <h3 class="text-xl font-bold mb-2">Cambios sin Guardar</h3>
            <p class="text-gray-300 mb-6">Hemos detectado que tienes cambios sin guardar. ¿Qué te gustaría hacer?</p>
            <div class="flex flex-col gap-3">
                <button id="unsaved-confirm-save" class="btn-primary">Guardar y Salir</button>
                <button id="unsaved-confirm-discard" class="btn-secondary !text-red-400 !border-red-500/50 hover:!bg-red-500/10">Descartar y Salir</button>
                <button id="unsaved-confirm-cancel" class="btn-secondary mt-2">Permanecer</button>
            </div>
        </div>
    </div>
    
     <!-- Modal Cambiar Contraseña -->
    <div id="password-change-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-md w-full">
            <h3 class="p-4 font-bold text-lg border-b border-gray-700">Cambiar Contraseña</h3>
            <div class="p-4 space-y-4">
                <div>
                    <label for="current-password-input" class="block mb-1 text-sm">Contraseña Actual</label>
                    <div class="relative"><input id="current-password-input" type="password" class="auth-input"><button id="current-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button></div>
                    <p id="current-password-error" class="text-red-400 text-xs mt-1 h-3"></p>
                </div>
                <div>
                    <label for="new-password-input" class="block mb-1 text-sm">Nueva Contraseña</label>
                    <div class="relative"><input id="new-password-input" type="password" class="auth-input"><button id="new-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button></div>
                     <p id="new-password-error" class="text-red-400 text-xs mt-1 h-3"></p>
                </div>
                 <div>
                    <label for="confirm-password-input" class="block mb-1 text-sm">Confirmar Nueva Contraseña</label>
                     <div class="relative"><input id="confirm-password-input" type="password" class="auth-input"><button id="confirm-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button></div>
                    <p id="confirm-password-error" class="text-red-400 text-xs mt-1 h-3"></p>
                </div>
            </div>
             <div class="p-4 flex justify-end gap-2 border-t border-gray-700">
                <button id="password-change-cancel-btn" class="btn-secondary">Cancelar</button>
                <button id="password-change-save-btn" class="btn-primary">Guardar Contraseña</button>
            </div>
        </div>
    </div>

    <!-- Modal Desactivar Cuenta -->
    <div id="delete-account-confirm-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-md w-full">
            <h3 class="p-4 font-bold text-lg border-b border-gray-700 text-red-400">¿Estás seguro?</h3>
            <div class="p-4 space-y-4">
                 <p class="text-gray-300">Esta acción es irreversible. Tu cuenta será programada para eliminación y todos tus datos se borrarán permanentemente después de 30 días.</p>
                 <p class="text-gray-300">Para confirmar, por favor, ingresa tu contraseña.</p>
                 <div>
                    <label for="delete-confirm-password-input" class="block mb-1 text-sm">Contraseña</label>
                    <div class="relative"><input id="delete-confirm-password-input" type="password" class="auth-input"><button id="delete-confirm-password-toggle" class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400"><i data-lucide="eye" class="w-5 h-5"></i></button></div>
                    <p id="delete-confirm-password-error" class="text-red-400 text-xs mt-1 h-3"></p>
                </div>
            </div>
            <div class="p-4 flex justify-end gap-2 border-t border-gray-700">
                <button id="delete-account-cancel-btn" class="btn-secondary">Cancelar</button>
                <button id="delete-account-confirm-btn" class="btn-primary !bg-red-600 hover:!bg-red-500">Sí, desactivar mi cuenta</button>
            </div>
        </div>
    </div>
    
     <!-- Modal Editor de Galería Unificado -->
    <div id="gallery-unified-editor-modal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full">
             <div class="p-4 flex justify-between items-center border-b border-gray-700">
                <h3 class="font-bold text-lg">Editar Imagen de la Galería</h3>
                <button id="gallery-unified-close-btn" class="p-2 rounded-full hover:bg-gray-700"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="flex p-4 gap-4">
                <!-- Columna Izquierda: Editor Principal -->
                <div class="w-2/3">
                    <div id="gallery-cropper-container" class="w-full aspect-[4/3] bg-gray-900">
                        <img id="gallery-cropper-image" src="">
                    </div>
                </div>
                <!-- Columna Derecha: Previsualización y Datos -->
                <div class="w-1/3 space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Previsualización de Miniatura (1:1)</label>
                        <div id="gallery-thumbnail-preview" class="aspect-square w-full bg-gray-900 rounded-lg overflow-hidden"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Previsualización en Perfil (Automático)</label>
                        <div class="aspect-video w-full bg-gray-900 rounded-lg overflow-hidden relative">
                            <img id="gallery-main-preview" src="" class="absolute w-full h-full object-cover">
                        </div>
                    </div>
                     <div>
                        <label for="gallery-caption-input" class="block text-sm font-medium mb-1">Pie de foto (opcional)</label>
                        <textarea id="gallery-caption-input" rows="3" class="auth-input"></textarea>
                    </div>
                </div>
            </div>
             <div class="p-4 flex justify-between items-center border-t border-gray-700">
                 <button id="gallery-delete-btn" class="btn-secondary !text-red-400 hover:!bg-red-500/10">Eliminar Imagen</button>
                 <div class="flex gap-2">
                    <button id="gallery-unified-cancel-btn" class="btn-secondary">Cancelar</button>
                    <button id="gallery-unified-save-btn" class="btn-primary">Guardar Cambios</button>
                 </div>
            </div>
        </div>
    </div>


    <!-- Alerta Personalizada -->
    <div id="custom-alert" class="fixed top-5 right-5 bg-blue-500 text-white py-2 px-4 rounded-lg shadow-lg z-50 hidden">
        <span id="custom-alert-message"></span>
        <button id="custom-alert-close" class="ml-4 font-bold">X</button>
    </div>

     <!-- Confirmación Personalizada -->
    <div id="custom-confirm" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 rounded-lg shadow-xl max-w-sm w-full p-6 text-center">
            <h3 class="text-xl font-bold mb-2">Confirmación</h3>
            <p id="custom-confirm-message" class="text-gray-300 mb-6"></p>
            <div class="flex gap-4">
                <button id="custom-confirm-cancel" class="btn-secondary w-full">Cancelar</button>
                <button id="custom-confirm-ok" class="btn-primary w-full !bg-red-600 hover:!bg-red-500">Aceptar</button>
            </div>
        </div>
    </div>
    
    <script src="gallery.js" defer></script>
    <script src="app.js" defer></script>
</body>
</html>


